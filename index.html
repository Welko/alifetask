<!DOCTYPE html>
<html>
<head>
    <title>Title</title>
    <style>
    </style>
</head>
<body>
    <div id="canvasContainer"></div>
    <button onclick="step()">Step</button>

    <script>
        function step() {
            app.update();
            app.render();
        }
    </script>

    <script type="module">
        import ALifeTask from './src/alifetask.js';

        const width = 512;
        const height = 512;

        window.app = new ALifeTask(width, height);
        app.domElement.style.width = `${width}px`;
        app.domElement.style.height = `${height}px`;
        document.getElementById('canvasContainer').appendChild(app.domElement);

        app.initialize({width, height}).then(() => {
            const mode = 'draw';
            const radius = 5;
            const faction = 0;
            const intensity = 1;
            
            const brush = (event, action) => {
                const br = app.domElement.getBoundingClientRect();
                const x = event.clientX - br.left;
                const y = event.clientY - br.top;
                app.brush({ action, mode, x, y, radius, faction, intensity });
                app.render();
            };

            app.domElement.addEventListener('mousedown', (e)=>brush(e, 'down'));
            app.domElement.addEventListener('mousemove', (e)=>brush(e, 'move'));
            app.domElement.addEventListener('mouseup', (e)=>brush(e, 'up'));
        });
    </script>
</body>
</html>